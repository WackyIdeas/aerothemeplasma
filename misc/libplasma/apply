#!/bin/bash

INSTALLDST="/usr/lib/x86_64-linux-gnu/qt6/qml/org/kde/plasma/core/libcorebindingsplugin.so"
LIBDIR="/usr/lib/x86_64-linux-gnu/"
TMPDIR="/opt/aerothemeplasma/tmp"

if [ ! -d ${LIBDIR} ]; then
	LIBDIR="/usr/lib64/"
fi

if [ ! -f ${INSTALLDST} ]; then
	INSTALLDST="/usr/lib64/qt6/qml/org/kde/plasma/core/libcorebindingsplugin.so"
fi

cp "$TMPDIR/libcorebindingsplugin.so" $INSTALLDST

for filename in "$TMPDIR/libPlasma"*; do
	echo "Copying $filename to $LIBDIR"
	cp "$filename" "$LIBDIR"
done

echo "Done."

systemctl disable apply-libplasma-patches.service
rm -f /etc/systemd/system/apply-libplasma-patches.service
rm -r $TMPDIR
